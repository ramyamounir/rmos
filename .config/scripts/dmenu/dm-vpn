#!/usr/bin/env sh

DMENU_OPTIONS=`dwm -m`

OPTIONS=(
    "USF"
    "Nord"
    "Home"
    "Lab"
    "Off"
)

PROMPT=""
for O in "${OPTIONS[@]}"; do
    PROMPT="$PROMPT$O\n"
done

CHOICE=$(printf "$PROMPT" | dmenu $DMENU_OPTIONS -i)

case $CHOICE in
    ${OPTIONS[0]})
        nmcli connect down nord;
        nmcli connect down home;
        nmcli connect down lab;

        echo -e "$(pass show emails/usf | tail -n 2 | head -n 1 | cut -d ':' -f 2 | xargs)\n$(pass show emails/usf | head -n 1)" | nmcli connection up usf --ask;
        notify-send -i "USF VPN" "Connected to USF"
        ;;
    ${OPTIONS[1]})
        nmcli connect down usf;
        nmcli connect down home;
        nmcli connect down lab;

        nmcli connect up nord;
        notify-send -i "Nord VPN" "Connected to Nord"
        ;;
    ${OPTIONS[2]})
        nmcli connect down usf;
        nmcli connect down lab;
        nmcli connect down nord;

        nmcli connect up home;
        notify-send -i "Home VPN" "Connected to Home"
        ;;
    ${OPTIONS[3]})
        nmcli connect down usf;
        nmcli connect down nord;
        nmcli connect down home;

        nmcli connect up lab;
        notify-send -i "Lab VPN" "Connected to Lab"
        ;;
    ${OPTIONS[4]})
        nmcli connect down usf;
        nmcli connect down nord;
        nmcli connect down home;
        nmcli connect down lab;
        notify-send -i "VPN" "Disconnected from VPN"
        ;;
    *)
        ;;
esac
