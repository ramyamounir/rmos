#!/usr/bin/env bash
set -euo pipefail

: "${PROJECT_ROOT:?PROJECT_ROOT is not set}"

EXPERIMENT_SCRIPT="$HOME/.config/scripts/tbp/pickers/tbp_experiments"
if [[ ! -x "$EXPERIMENT_SCRIPT" ]]; then
  echo "Missing experiment lister at $EXPERIMENT_SCRIPT" >&2
  exit 1
fi

choice="$("$EXPERIMENT_SCRIPT" | fzf --prompt='Experiment: ' \
  --delimiter=':' --with-nth=1 \
  --preview='echo Group: {2}' --preview-window=down:1:wrap || true)"

[[ -n "$choice" ]] || exit 1
printf '%s\n' "${choice%%:*}"
